---
verblock: "06 Mar 2025:v0.1: Matthew Sinclair - Initial version"
---
# ST0002: Core Script Framework

- **Status**: In Progress
- **Created**: 2025-03-06
- **Completed**:
- **Author**: LLM Assisted

## Objective

Implement the main `stp` script and command dispatching system that forms the core of the STP command-line interface.

## Context

The STP system needs a command-line interface to manage steel threads, initialize projects, and provide help. This steel thread focuses on creating the core script framework that will dispatch commands to their specific implementations.

## Approach

1. Create a main `stp` script that handles command dispatching
2. Implement environment variable handling and script location detection
3. Create a modular framework for command implementations
4. Implement error handling and usage information
5. Create a help system for displaying command documentation

## Tasks

- [x] Implement main `stp` script with command dispatching
- [x] Implement environment variable handling
- [x] Implement error handling framework
- [x] Create the help system script
- [x] Create help documentation for core commands
- [x] Implement the init script for project initialization
- [x] Implement the steel thread management script
- [ ] Test script functionality in various environments
- [ ] Add verbose output mode for debugging

## Implementation Notes

### Core Script Design

The core script framework follows a modular design where:

1. The main `stp` script:
   - Validates input parameters
   - Determines the STP_HOME directory
   - Dispatches to the appropriate command implementation
   - Handles basic error conditions

2. Command implementations:
   - Each command is implemented in a separate script named `stp_<command>`
   - Commands receive parameters directly from the main script
   - Commands handle their own parameter validation
   - Commands provide specific error messages

3. Help system:
   - Implemented in `stp_help`
   - Reads help documentation from `.help` directory
   - Provides both general and command-specific help

### Script Environment

The scripts use environment variables to maintain configuration:

- `STP_HOME`: Location of the STP installation
- `STP_PROJECT`: Current project name
- `STP_AUTHOR`: Default author name
- `STP_EDITOR`: Preferred text editor

The main script can determine `STP_HOME` automatically if not set.

### Error Handling

Error handling follows these principles:

- Exit with non-zero status on error
- Provide clear error messages to stderr
- Check prerequisites before operations
- Validate input parameters
- Handle script permissions issues

### Help Documentation

Help documentation follows a standard format with sections:

- `@short`: Brief one-line description
- `@desc`: Detailed description
- `@usage`: Usage information, parameters, and examples

## Results

[To be completed when the steel thread is finished]

## Related Steel Threads

- ST0001: Directory Structure
- ST0004: Steel Thread Commands
- ST0005: Initialization Command
- ST0006: Help System
