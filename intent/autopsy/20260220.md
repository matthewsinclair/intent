# Autopsy Report: 20260220

## Summary

- Sessions analyzed: 12 | Compactions: 5 | Date range: 2026-02-17 to 2026-02-20
- Corrections: 4 (1 post-compaction) | Frustration signals: 1
- User flags: 5 | Deferrals: 0 | Banned violations: 84 (3 real, 81 meta-referential)

## User Flags (highest confidence)

All 5 user flags are false positives -- the word "flag" appears in plan documents being pasted into sessions (e.g., "flag for autopsy", `-s|--start` flag documentation). None are actual user-placed markers during conversation.

| Session       | Line | Context                                           |
| ------------- | ---- | ------------------------------------------------- |
| `00314d4b...` | 2    | ST0022 plan text mentions `--start` flag          |
| `a1c29f27...` | 3    | ST0020 plan text mentions flag patterns           |
| `a1c29f27...` | 558  | Compaction summary references flag documentation  |
| `abd4de73...` | 2    | ST0021 plan text mentions "flag for autopsy"      |
| `abd4de73...` | 657  | Autopsy SKILL.md loaded (contains "flag" in docs) |

**Finding**: The user flag detection is too broad. It fires on plan documents pasted as user messages. Needs filtering for `type: "tool_result"` context or minimum message length thresholds.

## Memory Gaps (corrections with no matching rule)

### Gap 1: Avoid brittle test count assertions

- Evidence: Session `1228a7c5...`, line 270
  - User: (plan for WP-11 implementation)
  - Claude: "You're right -- asserting an exact count is brittle and meaningless. Every time a skill is added this test breaks."
- No matching MEMORY.md rule about test assertion style
- Proposed MEMORY.md addition:
  ```
  - Avoid brittle count assertions in tests -- test behavior and deltas, not absolute numbers
  ```

### Gap 2: Use full terminal width for display truncation

- Evidence: Session `adce1001...`, line 278
  - User: "Why not use the terminal full available width to truncate, not some arb length?"
  - Claude: "Tests pass, but you're right -- the issue is that `tput cols` returns 80 inside the sandbox..."
- The MEMORY.md documents terminal width detection but not the principle of using it
- Proposed MEMORY.md addition:
  ```
  - Always use detected terminal width for display truncation, never arbitrary fixed widths
  ```

## Enforcement Failures (rules violated despite existing)

### Failure 1: Em dash usage

- Rule (MEMORY.md line 37): "NEVER use em dashes (--) in skill files -- causes multi-byte truncation bugs in list display"
- Evidence: Session `a1c29f27...`, line 850
  - Claude wrote: "Absolutely right -- that AGENTS-phx.md content is c..."
  - The em dash rule applies to skill files specifically, but Claude used em dashes liberally in conversation text. The rule is scoped correctly (skill files only), but em dashes also appeared in tool_use:Write outputs in earlier sessions when writing documentation.
- Recommendation: Rule is correctly scoped. No change needed -- conversation text is fine, only SKILL.md files matter.

### Failure 2: Test count tracking in MEMORY.md

- Rule (MEMORY.md line 53): "Test count is tracked in CHANGELOG.md -- update it when adding tests"
- Evidence: User explicitly said "We don't need test counts, we favour quality over quantity when it comes to tests" during this session.
- The MEMORY.md itself contains a hardcoded test count on line 54 and line 86.
- Recommendation: Remove hardcoded test counts from MEMORY.md. Update the rule to not track counts.

## Undocumented Conventions

### Convention 1: Plans are pasted as user messages

Across all implementation sessions (`a1c29f27...`, `1228a7c5...`, `abd4de73...`, `00314d4b...`), the user consistently pastes full plan documents as the opening message with "Implement the following plan:". This is the primary interaction pattern -- not incremental instruction.

- Not captured in any memory file
- Proposed MEMORY.md addition:
  ```
  ## Interaction Pattern
  - User typically pastes full implementation plans as opening messages ("Implement the following plan:")
  - Plans contain full architecture, file lists, and step-by-step instructions
  - Claude should follow the plan structure, not re-plan
  ```

### Convention 2: Linter runs on markdown files

Multiple files were modified by a linter between edits during this session (table alignment in TPD docs, ST docs). This is not documented anywhere.

- Proposed MEMORY.md addition:
  ```
  - A markdown linter auto-formats files on save (table alignment, spacing)
  - Linter changes should be included in commits alongside intentional changes
  ```

### Convention 3: Release workflow includes GitHub release notes update

The tag + push + release notes update pattern was executed in this session. The MEMORY.md documents the tag workflow but the full `gh release edit` with inline notes (not just `--notes-file`) is not documented.

## Stale Memory

- **GitHub release workflow line**: `gh release edit v2.4.0 --notes-file docs/releases/2.4.0/RELEASE_NOTES.md` -- the actual workflow used `gh release edit v2.4.0 --notes "..."` with inline content, not a notes file. The notes file path may not exist.
- **Subagent list on line 18**: Lists "intent, elixir, socrates, worker-bee" but omits diogenes (added in ST0020 WP-11).

## Correction Pairs

| #   | Session       | Line | Post-compact | User excerpt                                                              | Assistant acknowledgment                                                 |
| --- | ------------- | ---- | ------------ | ------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| 1   | `1228a7c5...` | 270  | No           | (WP-11 plan -- Claude independently realized count assertion was brittle) | "You're right -- asserting an exact count is brittle and meaningless"    |
| 2   | `1228a7c5...` | 696  | **Yes**      | "add a new Claude Subagent called Autopsy... read here..."                | "Good, I've read everything. Here's what I've learned..."                |
| 3   | `a1c29f27...` | 438  | No           | (ST0020 plan -- Claude caught missing routing + stale copyright dates)    | "Good catch. Let me update the routing and fix all 2024 copyright dates" |
| 4   | `adce1001...` | 278  | No           | "Why not use the terminal full available width to truncate?"              | "Tests pass, but you're right -- tput cols returns 80 in sandbox..."     |

Correction #2 is post-compaction but is a false positive -- Claude said "Good" as an acknowledgment of reading material, not correcting an error.

**Real corrections**: #1 (brittle test assertion) and #4 (terminal width truncation). Both pre-compaction. Both resulted in code changes.

## Frustration Signals

| Session       | Line | Signals                                                          | Post-compact | Context                                                     |
| ------------- | ---- | ---------------------------------------------------------------- | ------------ | ----------------------------------------------------------- |
| `abd4de73...` | 2    | how many times, I told you, you forgot, wrong file, did you look | No           | False positive: ST0021 plan text contains these as examples |

**All frustration signals are false positives** -- they come from the autopsy plan document itself, which lists these exact phrases as detection patterns.

## Deferrals

None detected. Zero deferrals across 12 sessions.

## Banned Pattern Violations

### Real violations (3)

| Session       | Line | Pattern      | Label  | Source       | Context                                                |
| ------------- | ---- | ------------ | ------ | ------------ | ------------------------------------------------------ |
| `a1c29f27...` | 850  | "Absolutely" | ai_ism | conversation | "Absolutely right -- that AGENTS-phx.md content..."    |
| `a1c29f27...` | 1555 | "Absolutely" | ai_ism | conversation | "You're absolutely right -- this is an obvious gap..." |
| `a1c29f27...` | 185  | "overall"    | filler | tool_use     | "principles govern the overall structure of Elixir..." |

### Meta-referential violations (81)

81 violations are from session `1228a7c5...` and `abd4de73...` where the autopsy plan/code was being written. These sessions discuss banned words as examples ("delve", "unfortunately", "I'd be happy to") which the scanner correctly detects but are not actual violations. All from tool_use:Write, tool_use:Edit, tool_use:ExitPlanMode, or conversation quoting the plan.

## Second Pass

### Missed corrections

Reviewing user messages with emphasis or re-statements: none found beyond the 4 already detected. The interaction pattern (paste plan, execute plan) means corrections are rare -- the user provides detailed plans upfront.

### Deep scan

The 3 real banned violations are minor:

- "Absolutely" (2x in conversation) -- Claude used it as an intensifier before agreeing. Low severity.
- "overall" (1x in tool_use:Write) -- used in a technical document about Elixir architecture. Contextually appropriate.

### Deferral legitimacy

No deferrals to evaluate. Clean.

## Proposed Memory Updates

1. **Remove test count tracking** -- User explicitly requested this. Remove lines 53-54 from MEMORY.md (test count rule and current count), and line 86 (count in current state).

2. **Update subagent list** -- Line 18 should include diogenes.

3. **Fix GitHub release workflow** -- Line 8 should reflect both methods (notes-file and inline notes).

4. **Add terminal width principle** -- "Always use detected terminal width for display truncation."

5. **Add markdown linter convention** -- Note that a linter auto-formats markdown on save.

6. **Add interaction pattern** -- Document the plan-paste workflow.
